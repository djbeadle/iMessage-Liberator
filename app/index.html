<!DOCTYPE html>
<html>
  <head>
    <title>iMessage Tool</title>
  </head>
  <body>
    <h1>iMessage Tool</h1>
    <h2><a href="index.html">HOME</a></h2>
    <ul id="database">
    </ul>
    <script>
      const Config = require('electron-config');        
      const config = new Config();

      var sqlite3 = require('sqlite3').verbose();
      var db = new sqlite3.Database(config.get("db_path"));

      const URL = require('url').URL;

      var distinct_group_id =
        "select DISTINCT chat_identifier FROM chat;";

      db.serialize(function() {
        var rows = document.getElementById("database");
        db.each(distinct_group_id, function(err, row) {
          var item = document.createElement("li");
          
          var link = document.createElement("a");
          link.setAttribute("href", "chat.html?chat_identifier=" + encodeURIComponent(row.chat_identifier));
          link.textContent = row.chat_identifier;
          
          item.appendChild(link);
          rows.appendChild(item);
        });
      });

      db.close();
    </script>
  </body>
</html>
